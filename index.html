<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
  <title>Formulir Data</title>
</head>
<body>

<div class="container mt-5">
  <h2>Formulir Input Data</h2>

  <form id="dataForm">
    <div class="form-group">
      <label for="namaLengkap">Nama Lengkap:</label>
      <input type="text" class="form-control" id="namaLengkap" required>
    </div>
    <div class="form-group">
      <label for="nomorTelepon">Nomor Telepon:</label>
      <input type="tel" class="form-control" id="nomorTelepon" required>
    </div>
    <div class="form-group">
      <label for="rtRw">RT/RW:</label>
      <input type="text" class="form-control" id="rtRw" required>
    </div>
    <div class="form-group">
      <label for="dusun">Dusun:</label>
      <input type="text" class="form-control" id="dusun" required>
    </div>
    <div class="form-group">
      <label for="desa">Desa:</label>
      <input type="text" class="form-control" id="desa" required>
    </div>
    <div class="form-group">
      <label for="kecamatan">Kecamatan:</label>
      <input type="text" class="form-control" id="kecamatan" required>
    </div>

    <button type="button" class="btn btn-primary" onclick="simpanData()">Simpan</button>
  </form>
</div>

<script>
  function simpanData() {
    var namaLengkap = $('#namaLengkap').val();
    var nomorTelepon = $('#nomorTelepon').val();
    var rtRw = $('#rtRw').val();
    var dusun = $('#dusun').val();
    var desa = $('#desa').val();
    var kecamatan = $('#kecamatan').val();

    var rowData = [namaLengkap, nomorTelepon, rtRw, dusun, desa, kecamatan];

    // Simpan data ke Excel
    exportToExcel(rowData);

    // Bersihkan formulir setelah disimpan
    $('#dataForm')[0].reset();
  }

  function exportToExcel(data) {
    var wb = XLSX.utils.book_new();
    var ws = XLSX.utils.aoa_to_sheet([data]);

    XLSX.utils.book_append_sheet(wb, ws, "Data");
    
    // Simpan file Excel
    XLSX.writeFile(wb, "data.xlsx");
  }
</script>

</body>
</html>